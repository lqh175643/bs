import{s as S,_ as j,j as p,g as f,w as Z,v as W,o as d,c as _,b as t,n as h,F as C,d as V,t as g,x as E,p as N,q as R,u as X,y as U,z as Y,r as b,h as $,e as D,A as L,B as P,a as ee,i as te,C as ae,k as ne,D as se,E as B,f as A,H as F}from"./index-0598f3a8.js";import{S as oe}from"./Shoping-74d6af9d.js";import"./order-9b975a2b.js";function ie(a){return a&&(a=a.map(n=>n.includes("url")?n.split(/\(|\)/)[1]:n),a=a.filter(n=>{if(n!="none"&&n!=null)return n}),a=a.map(n=>n.split('"')[1])),a}function M(a){return S({url:`/detail/${a.category}/${a.id}`,method:"get"})}function ce(a){return S({url:"/detail/operation",method:"post",data:a})}function le(a){return S({url:"/userInfo/collection",method:"post",data:a})}function de(a){return S({url:"/detail/commitZan",method:"post",data:a})}function re(a){return S({url:"/detail/commitChd",method:"post",data:a})}const _e={name:"ImagesSwiper",props:{images:{type:Array,default:()=>[]}},setup(a){let n=p(()=>a.images.length),s=f(0);Z(n,(l,x)=>{s.value=l>=5?5:n.value});let e=f(""),u=f(0);const v=function(){let l=s.value-5;l<=0||(l>=4?(s.value-=4,e.value.style.transform=`translateX(${-(s.value-5)*20}%)`):(s.value-=l,e.value.style.transform=`translateX(${-(s.value-5)*20}%)`))},o=function(){let l=n.value-s.value;l<=0||(l>=4?(s.value+=4,e.value.style.transform=`translateX(${-(s.value-5)*20}%)`):(s.value+=l,e.value.style.transform=`translateX(${-(s.value-5)*20}%)`))},m=function(l){l.target!==l.currentTarget&&(u.value=l.target.dataset.index)};W(()=>{e.value=document.getElementsByClassName("img_swiper_wrapper")[0]});const r=p(()=>a.images[u.value]?.replace("com/n5","com/n1"));return{preClick:v,nextClick:o,currentIndex:u,changeImg:m,getBigImg:r}}},ue={class:"wrapper"},me={class:"big_img"},ve=["src"],ge={class:"left_swiper"},fe={class:"img_swiper"},he=["src","data-index"];function pe(a,n,s,e,u,v){return d(),_("div",ue,[t("div",me,[t("img",{src:e.getBigImg,alt:""},null,8,ve)]),t("div",ge,[t("div",null,[t("i",{class:h(["iconfont","icon-shangyiyehoutuifanhui","pre"]),onClick:n[0]||(n[0]=(...o)=>e.preClick&&e.preClick(...o))})]),t("div",fe,[t("div",{class:"img_swiper_wrapper",onMouseover:n[1]||(n[1]=(...o)=>e.changeImg&&e.changeImg(...o))},[(d(!0),_(C,null,V(s.images,(o,m)=>(d(),_("img",{key:m,src:o,"data-index":m,alt:"展示图片",class:h(["img_item",m==e.currentIndex?"active":""])},null,10,he))),128))],32)]),t("div",null,[t("i",{class:h(["iconfont","icon-xiayiyeqianjinchakangengduo","next"]),onClick:n[2]||(n[2]=(...o)=>e.nextClick&&e.nextClick(...o))})])])])}const be=j(_e,[["render",pe],["__scopeId","data-v-fa636ee9"]]);const ye={name:"Price",props:{price:{type:[Number,String],default:"100"}}},T=a=>(N("data-v-a1b44867"),a=a(),R(),a),Ce={class:"wrapper"},xe={class:"price"},ke=T(()=>t("span",{class:"margin_right_10"},"校园价",-1)),De={class:"normal_price"},Ve={class:"plus"},we={class:"plus_price"},Ie=T(()=>t("span",{class:"plus_detail"},"PLUS会员专享价",-1)),Se=T(()=>t("span",{class:"plus_go"},"现在开通PLUS会员享限时特惠",-1)),je=E('<div class="compus_bean" data-v-a1b44867><span class="margin_right_10" data-v-a1b44867>校园豆</span><span class="compus_bean_" data-v-a1b44867>1000豆可以抵10元</span></div><div class="common_count" data-v-a1b44867><div class="common_count_text" data-v-a1b44867>累计评价</div><div class="common_count_bom" data-v-a1b44867>10+</div></div><div class="promotion" data-v-a1b44867><span class="margin_right_10" data-v-a1b44867>促 销</span><span class="promotion_text" data-v-a1b44867><span class="promotion_logo" data-v-a1b44867>多买优惠</span><div class="next_line" data-v-a1b44867>满2件,总价打9.50折;满3件,总价打9.0折</div></span></div>',3);function ze(a,n,s,e,u,v){return d(),_("div",Ce,[t("div",xe,[ke,t("span",De,g("￥"+s.price),1),t("div",Ve,[t("span",we,g("￥"+(s.price*.95).toFixed(2)),1),Ie,Se])]),je])}const Be=j(ye,[["render",ze],["__scopeId","data-v-a1b44867"]]);const Pe={name:"Commit",props:{commentData:{type:[Object,String],default:()=>{}},jid:{type:String,default:""},category:{type:String,defalut:""}},setup(a,{emit:n}){const s=X(),e=f(""),u=f(!1),v=p(()=>U(a.commentData.time)||"2022-01-03"),o=p(()=>a.commentData?.children?.length||0),m=p(()=>a.commentData?.zanCount||0),r=p(()=>a.commentData?.val||a.commentData),l=p(()=>a.commentData?.score||5),x=p(()=>a.commentData?.zanFroms?.includes(s.getters.userId));return{time:v,commitCount:o,zanCount:m,content:r,score:l,zan:()=>{de({jid:a.jid,category:a.category,toUid:a.commentData.uid,cid:a.commentData.cid}).then(i=>{n("refresh")}).catch(i=>{console.log(i)})},isZan:x,commit:()=>{const i={jid:a.jid,cid:a.commentData.cid,category:a.category,val:e.value};re(i).then(y=>{n("refresh"),e.value=""}).catch(y=>{console.log(y)})},replyVal:e,dialogVisible:u,formatDate:U,hideName:Y}}},Ne=a=>(N("data-v-84abff49"),a=a(),R(),a),Re={class:"wrapper"},Te={class:"head_pic"},Ue={class:"star"},Ae={class:"head_pic_wrapper"},Fe={key:0,src:"",alt:""},Me={key:1,class:h(["iconfont","icon-anonymous"])},Ze={key:0,class:"head_vip"},Ee=Ne(()=>t("span",null,"超级会员",-1)),Xe=[Ee],$e={class:"content"},Le={class:"time"},qe={class:"zanCount"},He={class:"commitChild"},Oe={class:"commit_btn"},Ge={class:"child_name"},Je={class:"child_val"},Ke={class:"child_time"};function Qe(a,n,s,e,u,v){const o=b("el-input"),m=b("el-button");return d(),_(C,null,[t("div",Re,[t("div",Te,[t("div",Ue,[(d(),_(C,null,V(5,r=>t("i",{key:r,class:h(["iconfont","icon-aixin","star_icon",e.score>=r?"active_star":"inactive_star"])},null,2)),64))]),t("div",Ae,[s.commentData?.isAnonymous?(d(),_("img",Fe)):(d(),_("i",Me))]),s.commentData?.isVip?$("",!0):(d(),_("div",Ze,Xe))]),t("div",$e,[t("div",null,g(e.content),1),t("span",Le,g(e.time),1),t("i",qe,g(e.zanCount),1),t("i",{class:h(["iconfont","icon-dianzan_kuai","zan",e.isZan?"isZan":""]),onClick:n[0]||(n[0]=(...r)=>e.zan&&e.zan(...r))},null,2),t("i",He,g(e.commitCount),1),t("i",{class:h(["iconfont","icon-pinglun","commit"]),onClick:n[1]||(n[1]=r=>e.dialogVisible=!e.dialogVisible)})])]),t("div",{class:h(["content_children",e.dialogVisible?"height_change":""])},[D(o,{modelValue:e.replyVal,"onUpdate:modelValue":n[2]||(n[2]=r=>e.replyVal=r),rows:4,type:"textarea"},null,8,["modelValue"]),t("div",Oe,[D(m,{size:"small",onClick:e.commit},{default:L(()=>[P("提交")]),_:1},8,["onClick"])]),(d(!0),_(C,null,V(s.commentData?.children,(r,l)=>(d(),_("div",{key:l,class:"child_wrapper"},[t("span",Ge,g(e.hideName(r.uid)+"："),1),t("span",Je,g(r.val),1),t("div",Ke,g(e.formatDate(r.time)),1)]))),128))],2)],64)}const We=j(Pe,[["render",Qe],["__scopeId","data-v-84abff49"]]);const Ye={name:"Detail",components:{ImagesSwiper:be,Price:Be,Commit:We,Shoping:oe},setup(a){const n=ee(),s=X(),e=f(!1),u=n.currentRoute.value.params.id,v=n.currentRoute.value.params.category,o=f({}),m=f(""),r=f(0),l={id:u,category:v},x=f(1),I=f([]),k=te({img:"",des:"",price:"",jid:u,count:1}),y=s.getters.receivingAddress.map(c=>({value:c.addr_id,label:c.user+" "+ae(c.receivingAddress)+" "+c.phoneNumber})),q=function(){},H=function(c){c.target!==c.currentTarget&&(r.value=c.target.dataset.index)},O=function(){e.value=!0},G=function(){const c=o.value.id;u&&ce({target:"shopBus",jid:c,count:Number(x.value),category:v}).then(z=>{F({message:"加入购物车成功",type:"success",offset:60}),B(s)})},J=function(){const c=o.value.id;u&&le({target:"collect",jid:c,category:v}).then(z=>{F({message:"收藏成功",type:"success",offset:60}),B(s)})};ne(()=>{M(l).then(c=>{o.value=c,k.img=c.images[0].replace("/n5/","/n1/"),k.des=c.productDescription,k.price=c.price;const z=o.value.id;return Promise.resolve(z)}).then(c=>se({jid:c,target:"footprint"})).then(c=>{B(s)},c=>{console.log(c)})});const K=p(()=>`(${o.value.comment?.length>=10?"10+":""})`),Q=p(()=>o.value.comment);return Z(()=>o.value.introductionPicture,()=>{I.value=ie(o.value.introductionPicture)}),{dialogTableVisible:e,detailData:o,count:x,address_value:m,handleChange:q,addBus:G,goodsCount:K,header_item_index:r,headerChange:H,proPic:I,shoucang:J,buy:O,detailDataComment:Q,buyData:k,jid:u,category:v,commitRefresh:()=>{M(l).then(c=>{o.value.comment=c.comment}).catch(c=>{console.log(c)})},receiveInfo:y}}},w=a=>(N("data-v-7db298ff"),a=a(),R(),a),et={class:"detail_wrapper"},tt={class:"left_swiper"},at=w(()=>t("div",{class:"middle"},null,-1)),nt={class:"right_detail"},st={class:"detail_text"},ot=w(()=>t("span",{class:""},null,-1)),it={class:"detail_price"},ct={class:"address"},lt=w(()=>t("span",{class:"margin-right-10"},"配 送 至",-1)),dt={class:"address-select"},rt=w(()=>t("span",{class:"address_count"},"80",-1)),_t={class:"count"},ut=w(()=>t("span",{class:"margin-right-10"},"数  量",-1)),mt={class:"counter"},vt=w(()=>t("div",{class:"pay_func"},[t("span",{class:"margin-right-10"},"支付方式"),t("span",{class:"func"},"微信"),t("span",null,"支付宝")],-1)),gt={class:"footer"},ft=E('<div class="service" data-v-7db298ff><span class="margin-right-10" data-v-7db298ff>服务说明</span><span data-v-7db298ff><i class="iconfont icon-kongxinduigou" data-v-7db298ff></i>1小时内发货 </span><span data-v-7db298ff><i class="iconfont icon-kongxinduigou" data-v-7db298ff></i>2天无理由退货 </span><span data-v-7db298ff><i class="iconfont icon-kongxinduigou" data-v-7db298ff></i>全校包邮 </span><br data-v-7db298ff><span class="next-line" data-v-7db298ff><i class="iconfont icon-kongxinduigou" data-v-7db298ff></i>延误必赔 </span></div>',1),ht={class:"picture_and_comment"},pt={key:0,class:"picture"},bt=["src"],yt={key:1,class:"commit"};function Ct(a,n,s,e,u,v){const o=b("ImagesSwiper"),m=b("Price"),r=b("el-option"),l=b("el-select"),x=b("el-input-number"),I=b("Commit"),k=b("Shoping");return d(),_(C,null,[t("div",et,[t("div",tt,[D(o,{images:e.detailData.images},null,8,["images"])]),at,t("div",nt,[t("div",st,[ot,P(" "+g(e.detailData.productDescription),1)]),t("div",it,[D(m,{price:e.detailData.price},null,8,["price"])]),t("div",ct,[lt,t("span",dt,[D(l,{modelValue:e.address_value,"onUpdate:modelValue":n[0]||(n[0]=i=>e.address_value=i),placeholder:"Select"},{default:L(()=>[(d(!0),_(C,null,V(e.receiveInfo,i=>(d(),A(r,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P(" 库存 "),rt]),t("div",_t,[ut,t("span",mt,[D(x,{modelValue:e.buyData.count,"onUpdate:modelValue":n[1]||(n[1]=i=>e.buyData.count=i),min:1,max:10,onChange:e.handleChange},null,8,["modelValue","onChange"])])]),vt,t("div",gt,[t("i",{class:h(["iconfont","icon-shoucang","shoucang"]),onClick:n[2]||(n[2]=(...i)=>e.shoucang&&e.shoucang(...i))}),t("div",{class:"buy",onClick:n[3]||(n[3]=(...i)=>e.buy&&e.buy(...i))},"立即购买"),t("div",{class:"bus",onClick:n[4]||(n[4]=(...i)=>e.addBus&&e.addBus(...i))},"加入购物车")]),ft])]),t("div",ht,[t("div",{class:"picture_and_comment_header",onClick:n[5]||(n[5]=(...i)=>e.headerChange&&e.headerChange(...i))},[t("div",{class:h(["header_item",e.header_item_index==0?"active_item":""]),"data-index":"0"}," 商品介绍 ",2),t("div",{class:h(["header_item",e.header_item_index==1?"active_item":""]),"data-index":"1"}," 商品评价"+g(e.goodsCount),3)]),e.header_item_index==0?(d(),_("div",pt,[(d(!0),_(C,null,V(e.proPic,(i,y)=>(d(),_("img",{key:y,src:i,alt:""},null,8,bt))),128))])):(d(),_("div",yt,[(d(!0),_(C,null,V(e.detailDataComment,(i,y)=>(d(),_("div",{key:y,class:"commit_item"},[D(I,{commentData:i,jid:e.jid,category:e.category,onRefresh:e.commitRefresh},null,8,["commentData","jid","category","onRefresh"])]))),128))]))]),e.dialogTableVisible?(d(),A(k,{key:0,dialogTableVisible:e.dialogTableVisible,buyData:e.buyData,propReceive:e.address_value,onShopClose:n[6]||(n[6]=i=>e.dialogTableVisible=!1)},null,8,["dialogTableVisible","buyData","propReceive"])):$("",!0)],64)}const wt=j(Ye,[["render",Ct],["__scopeId","data-v-7db298ff"]]);export{wt as default};
