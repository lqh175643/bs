import{k as C,r as f,C as Z,D as W,o as d,g as r,f as t,h as b,F as D,q as w,t as p,v as N,x as R,G as X,i as $,d as k,l as E,m as V,w as L,p as P,u as Y,j as ee,y as te,e as U,s as A}from"./vendor.d3eff5ec.js";import{i as S,_ as j,f as F,h as ae,a as ne,b as se,d as B}from"./index.744d850d.js";import{S as oe}from"./Shoping.67885a04.js";import"./order.30eef523.js";function ie(a){return a&&(a=a.map(n=>n.includes("url")?n.split(/\(|\)/)[1]:n),a=a.filter(n=>{if(n!="none"&&n!=null)return n}),a=a.map(n=>n.split('"')[1])),a}function M(a){return S({url:`/detail/${a.category}/${a.id}`,method:"get"})}function ce(a){return S({url:"/detail/operation",method:"post",data:a})}function le(a){return S({url:"/userInfo/collection",method:"post",data:a})}function de(a){return S({url:"/detail/commitZan",method:"post",data:a})}function re(a){return S({url:"/detail/commitChd",method:"post",data:a})}const _e={name:"ImagesSwiper",props:{images:{type:Array,default:()=>[]}},setup(a){let n=C(()=>a.images.length),i=f(0);Z(n,(l,y)=>{i.value=l>=5?5:n.value});let e=f(""),u=f(0);const g=function(){let l=i.value-5;l<=0||(l>=4?(i.value-=4,e.value.style.transform=`translateX(${-(i.value-5)*20}%)`):(i.value-=l,e.value.style.transform=`translateX(${-(i.value-5)*20}%)`))},c=function(){let l=n.value-i.value;l<=0||(l>=4?(i.value+=4,e.value.style.transform=`translateX(${-(i.value-5)*20}%)`):(i.value+=l,e.value.style.transform=`translateX(${-(i.value-5)*20}%)`))},v=function(l){l.target!==l.currentTarget&&(u.value=l.target.dataset.index)};W(()=>{e.value=document.getElementsByClassName("img_swiper_wrapper")[0]});const h=C(()=>{var l;return(l=a.images[u.value])==null?void 0:l.replace("com/n5","com/n1")});return{preClick:g,nextClick:c,currentIndex:u,changeImg:v,getBigImg:h}}},ue={class:"wrapper"},me={class:"big_img"},ve=["src"],ge={class:"left_swiper"},he={class:"img_swiper"},pe=["src","data-index"];function fe(a,n,i,e,u,g){return d(),r("div",ue,[t("div",me,[t("img",{src:e.getBigImg,alt:""},null,8,ve)]),t("div",ge,[t("div",null,[t("i",{class:b(["iconfont","icon-shangyiyehoutuifanhui","pre"]),onClick:n[0]||(n[0]=(...c)=>e.preClick&&e.preClick(...c))})]),t("div",he,[t("div",{class:"img_swiper_wrapper",onMouseover:n[1]||(n[1]=(...c)=>e.changeImg&&e.changeImg(...c))},[(d(!0),r(D,null,w(i.images,(c,v)=>(d(),r("img",{key:v,src:c,"data-index":v,alt:"\u5C55\u793A\u56FE\u7247",class:b(["img_item",v==e.currentIndex?"active":""])},null,10,pe))),128))],32)]),t("div",null,[t("i",{class:b(["iconfont","icon-xiayiyeqianjinchakangengduo","next"]),onClick:n[2]||(n[2]=(...c)=>e.nextClick&&e.nextClick(...c))})])])])}var be=j(_e,[["render",fe],["__scopeId","data-v-43e1e8cb"]]);const ye={name:"Price",props:{price:{type:[Number,String],default:"100"}}},T=a=>(N("data-v-00b31bc6"),a=a(),R(),a),Ce={class:"wrapper"},xe={class:"price"},ke=T(()=>t("span",{class:"margin_right_10"},"\u6821\u56ED\u4EF7",-1)),De={class:"normal_price"},Ve={class:"plus"},we={class:"plus_price"},Ie=T(()=>t("span",{class:"plus_detail"},"PLUS\u4F1A\u5458\u4E13\u4EAB\u4EF7",-1)),Se=T(()=>t("span",{class:"plus_go"},"\u73B0\u5728\u5F00\u901APLUS\u4F1A\u5458\u4EAB\u9650\u65F6\u7279\u60E0",-1)),je=X('<div class="compus_bean" data-v-00b31bc6><span class="margin_right_10" data-v-00b31bc6>\u6821\u56ED\u8C46</span><span class="compus_bean_" data-v-00b31bc6>1000\u8C46\u53EF\u4EE5\u62B510\u5143</span></div><div class="common_count" data-v-00b31bc6><div class="common_count_text" data-v-00b31bc6>\u7D2F\u8BA1\u8BC4\u4EF7</div><div class="common_count_bom" data-v-00b31bc6>10+</div></div><div class="promotion" data-v-00b31bc6><span class="margin_right_10" data-v-00b31bc6>\u4FC3\xA0\u9500</span><span class="promotion_text" data-v-00b31bc6><span class="promotion_logo" data-v-00b31bc6>\u591A\u4E70\u4F18\u60E0</span><div class="next_line" data-v-00b31bc6>\u6EE12\u4EF6,\u603B\u4EF7\u62539.50\u6298;\u6EE13\u4EF6,\u603B\u4EF7\u62539.0\u6298</div></span></div>',3);function ze(a,n,i,e,u,g){return d(),r("div",Ce,[t("div",xe,[ke,t("span",De,p("\uFFE5"+i.price),1),t("div",Ve,[t("span",we,p("\uFFE5"+(i.price*.95).toFixed(2)),1),Ie,Se])]),je])}var Be=j(ye,[["render",ze],["__scopeId","data-v-00b31bc6"]]);const Pe={name:"Commit",props:{commentData:{type:[Object,String],default:()=>{}},jid:{type:String,default:""},category:{type:String,defalut:""}},setup(a,{emit:n}){const i=$(),e=f(""),u=f(!1),g=C(()=>F(a.commentData.time)||"2022-01-03"),c=C(()=>{var s,m;return((m=(s=a.commentData)==null?void 0:s.children)==null?void 0:m.length)||0}),v=C(()=>{var s;return((s=a.commentData)==null?void 0:s.zanCount)||0}),h=C(()=>{var s;return((s=a.commentData)==null?void 0:s.val)||a.commentData}),l=C(()=>{var s;return((s=a.commentData)==null?void 0:s.score)||5}),y=C(()=>{var s,m;return(m=(s=a.commentData)==null?void 0:s.zanFroms)==null?void 0:m.includes(i.getters.userId)});return{time:g,commitCount:c,zanCount:v,content:h,score:l,zan:()=>{de({jid:a.jid,category:a.category,toUid:a.commentData.uid,cid:a.commentData.cid}).then(s=>{n("refresh")}).catch(s=>{console.log(s)})},isZan:y,commit:()=>{const s={jid:a.jid,cid:a.commentData.cid,category:a.category,val:e.value};re(s).then(m=>{n("refresh"),e.value=""}).catch(m=>{console.log(m)})},replyVal:e,dialogVisible:u,formatDate:F,hideName:ae}}},Ne=a=>(N("data-v-486c5110"),a=a(),R(),a),Re={class:"wrapper"},Te={class:"head_pic"},Ue={class:"star"},Ae={class:"head_pic_wrapper"},Fe={key:0,src:"",alt:""},Me={key:1,class:b(["iconfont","icon-anonymous"])},Ze={key:0,class:"head_vip"},Xe=Ne(()=>t("span",null,"\u8D85\u7EA7\u4F1A\u5458",-1)),$e=[Xe],Ee={class:"content"},Le={class:"time"},qe={class:"zanCount"},Ge={class:"commitChild"},Oe={class:"commit_btn"},He={class:"child_name"},Je={class:"child_val"},Ke={class:"child_time"};function Qe(a,n,i,e,u,g){var h,l,y;const c=k("el-input"),v=k("el-button");return d(),r(D,null,[t("div",Re,[t("div",Te,[t("div",Ue,[(d(),r(D,null,w(5,_=>t("i",{key:_,class:b(["iconfont","icon-aixin","star_icon",e.score>=_?"active_star":"inactive_star"])},null,2)),64))]),t("div",Ae,[(h=i.commentData)!=null&&h.isAnonymous?(d(),r("img",Fe)):(d(),r("i",Me))]),(l=i.commentData)!=null&&l.isVip?E("",!0):(d(),r("div",Ze,$e))]),t("div",Ee,[t("div",null,p(e.content),1),t("span",Le,p(e.time),1),t("i",qe,p(e.zanCount),1),t("i",{class:b(["iconfont","icon-dianzan_kuai","zan",e.isZan?"isZan":""]),onClick:n[0]||(n[0]=(..._)=>e.zan&&e.zan(..._))},null,2),t("i",Ge,p(e.commitCount),1),t("i",{class:b(["iconfont","icon-pinglun","commit"]),onClick:n[1]||(n[1]=_=>e.dialogVisible=!e.dialogVisible)})])]),t("div",{class:b(["content_children",e.dialogVisible?"height_change":""])},[V(c,{modelValue:e.replyVal,"onUpdate:modelValue":n[2]||(n[2]=_=>e.replyVal=_),rows:4,type:"textarea"},null,8,["modelValue"]),t("div",Oe,[V(v,{size:"small",onClick:e.commit},{default:L(()=>[P("\u63D0\u4EA4")]),_:1},8,["onClick"])]),(d(!0),r(D,null,w((y=i.commentData)==null?void 0:y.children,(_,x)=>(d(),r("div",{key:x,class:"child_wrapper"},[t("span",He,p(e.hideName(_.uid)+"\uFF1A"),1),t("span",Je,p(_.val),1),t("div",Ke,p(e.formatDate(_.time)),1)]))),128))],2)],64)}var We=j(Pe,[["render",Qe],["__scopeId","data-v-486c5110"]]);const Ye={name:"Detail",components:{ImagesSwiper:be,Price:Be,Commit:We,Shoping:oe},setup(a){const n=Y(),i=$(),e=f(!1),u=n.currentRoute.value.params.id,g=n.currentRoute.value.params.category,c=f({}),v=f(""),h=f(0),l={id:u,category:g},y=f(1),_=f([]),x=ee({img:"",des:"",price:"",jid:u,count:1}),m=i.getters.receivingAddress.map(o=>({value:o.addr_id,label:o.user+" "+ne(o.receivingAddress)+" "+o.phoneNumber})),q=function(){},G=function(o){o.target!==o.currentTarget&&(h.value=o.target.dataset.index)},O=function(){e.value=!0},H=function(){const o=c.value.id;u&&ce({target:"shopBus",jid:o,count:Number(y.value),category:g}).then(z=>{A({message:"\u52A0\u5165\u8D2D\u7269\u8F66\u6210\u529F",type:"success",offset:60}),B(i)})},J=function(){const o=c.value.id;u&&le({target:"collect",jid:o,category:g}).then(z=>{A({message:"\u6536\u85CF\u6210\u529F",type:"success",offset:60}),B(i)})};te(()=>{M(l).then(o=>{c.value=o,x.img=o.images[0].replace("/n5/","/n1/"),x.des=o.productDescription,x.price=o.price;const z=c.value.id;return Promise.resolve(z)}).then(o=>se({jid:o,target:"footprint"})).then(o=>{B(i)},o=>{console.log(o)})});const K=C(()=>{var o;return`(${((o=c.value.comment)==null?void 0:o.length)>=10?"10+":""})`}),Q=C(()=>c.value.comment);return Z(()=>c.value.introductionPicture,()=>{_.value=ie(c.value.introductionPicture)}),{dialogTableVisible:e,detailData:c,count:y,address_value:v,handleChange:q,addBus:H,goodsCount:K,header_item_index:h,headerChange:G,proPic:_,shoucang:J,buy:O,detailDataComment:Q,buyData:x,jid:u,category:g,commitRefresh:()=>{M(l).then(o=>{c.value.comment=o.comment}).catch(o=>{console.log(o)})},receiveInfo:m}}},I=a=>(N("data-v-17c2800a"),a=a(),R(),a),et={class:"detail_wrapper"},tt={class:"left_swiper"},at=I(()=>t("div",{class:"middle"},null,-1)),nt={class:"right_detail"},st={class:"detail_text"},ot=I(()=>t("span",{class:""},null,-1)),it={class:"detail_price"},ct={class:"address"},lt=I(()=>t("span",{class:"margin-right-10"},"\u914D\u2002\u9001\u2002\u81F3",-1)),dt={class:"address-select"},rt=I(()=>t("span",{class:"address_count"},"80",-1)),_t={class:"count"},ut=I(()=>t("span",{class:"margin-right-10"},"\u6570\xA0\xA0\u91CF",-1)),mt={class:"counter"},vt=I(()=>t("div",{class:"pay_func"},[t("span",{class:"margin-right-10"},"\u652F\u4ED8\u65B9\u5F0F"),t("span",{class:"func"},"\u5FAE\u4FE1"),t("span",null,"\u652F\u4ED8\u5B9D")],-1)),gt={class:"footer"},ht=X('<div class="service" data-v-17c2800a><span class="margin-right-10" data-v-17c2800a>\u670D\u52A1\u8BF4\u660E</span><span data-v-17c2800a><i class="iconfont icon-kongxinduigou" data-v-17c2800a></i>1\u5C0F\u65F6\u5185\u53D1\u8D27 </span><span data-v-17c2800a><i class="iconfont icon-kongxinduigou" data-v-17c2800a></i>2\u5929\u65E0\u7406\u7531\u9000\u8D27 </span><span data-v-17c2800a><i class="iconfont icon-kongxinduigou" data-v-17c2800a></i>\u5168\u6821\u5305\u90AE </span><br data-v-17c2800a><span class="next-line" data-v-17c2800a><i class="iconfont icon-kongxinduigou" data-v-17c2800a></i>\u5EF6\u8BEF\u5FC5\u8D54 </span></div>',1),pt={class:"picture_and_comment"},ft={key:0,class:"picture"},bt=["src"],yt={key:1,class:"commit"};function Ct(a,n,i,e,u,g){const c=k("ImagesSwiper"),v=k("Price"),h=k("el-option"),l=k("el-select"),y=k("el-input-number"),_=k("Commit"),x=k("Shoping");return d(),r(D,null,[t("div",et,[t("div",tt,[V(c,{images:e.detailData.images},null,8,["images"])]),at,t("div",nt,[t("div",st,[ot,P(" "+p(e.detailData.productDescription),1)]),t("div",it,[V(v,{price:e.detailData.price},null,8,["price"])]),t("div",ct,[lt,t("span",dt,[V(l,{modelValue:e.address_value,"onUpdate:modelValue":n[0]||(n[0]=s=>e.address_value=s),placeholder:"Select"},{default:L(()=>[(d(!0),r(D,null,w(e.receiveInfo,s=>(d(),U(h,{key:s.value,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P(" \u5E93\u5B58 "),rt]),t("div",_t,[ut,t("span",mt,[V(y,{modelValue:e.buyData.count,"onUpdate:modelValue":n[1]||(n[1]=s=>e.buyData.count=s),min:1,max:10,onChange:e.handleChange},null,8,["modelValue","onChange"])])]),vt,t("div",gt,[t("i",{class:b(["iconfont","icon-shoucang","shoucang"]),onClick:n[2]||(n[2]=(...s)=>e.shoucang&&e.shoucang(...s))}),t("div",{class:"buy",onClick:n[3]||(n[3]=(...s)=>e.buy&&e.buy(...s))},"\u7ACB\u5373\u8D2D\u4E70"),t("div",{class:"bus",onClick:n[4]||(n[4]=(...s)=>e.addBus&&e.addBus(...s))},"\u52A0\u5165\u8D2D\u7269\u8F66")]),ht])]),t("div",pt,[t("div",{class:"picture_and_comment_header",onClick:n[5]||(n[5]=(...s)=>e.headerChange&&e.headerChange(...s))},[t("div",{class:b(["header_item",e.header_item_index==0?"active_item":""]),"data-index":"0"}," \u5546\u54C1\u4ECB\u7ECD ",2),t("div",{class:b(["header_item",e.header_item_index==1?"active_item":""]),"data-index":"1"}," \u5546\u54C1\u8BC4\u4EF7"+p(e.goodsCount),3)]),e.header_item_index==0?(d(),r("div",ft,[(d(!0),r(D,null,w(e.proPic,(s,m)=>(d(),r("img",{key:m,src:s,alt:""},null,8,bt))),128))])):(d(),r("div",yt,[(d(!0),r(D,null,w(e.detailDataComment,(s,m)=>(d(),r("div",{key:m,class:"commit_item"},[V(_,{commentData:s,jid:e.jid,category:e.category,onRefresh:e.commitRefresh},null,8,["commentData","jid","category","onRefresh"])]))),128))]))]),e.dialogTableVisible?(d(),U(x,{key:0,dialogTableVisible:e.dialogTableVisible,buyData:e.buyData,propReceive:e.address_value,onShopClose:n[6]||(n[6]=s=>e.dialogTableVisible=!1)},null,8,["dialogTableVisible","buyData","propReceive"])):E("",!0)],64)}var It=j(Ye,[["render",Ct],["__scopeId","data-v-17c2800a"]]);export{It as default};
