import{_ as D,g as b,a as x,u as B,k as j,r as m,o as _,c as u,e as s,A as n,F as C,H as v,E as A,b as i,t as E,d as N,h as U,B as w}from"./index-8ec311e0.js";import{g as R,d as S}from"./userHome-97f96ce9.js";const F={name:"Collection",setup(V){const l=b([]),y=b(""),t=x(),p=b(!1),g=B(),a=e=>{l.value=[],R({ids:e}).then(r=>{Array.isArray(r)&&r.length>0&&r.forEach((d,z)=>{l.value.push({goods:{img:d.imgUrl,des:d.detail,category:d.category},jid:d.id,price:d.price.split("￥")[1],operation:["delete"]})})},r=>{console.log(r)})},h=e=>e.jid,f=e=>{p.value=!0,y.value=e.jid},k=()=>{S({val:y.value,target:"collect"}).then(async e=>{v({message:"删除成功",type:"success",offset:60}),await A(g),a(g.getters.collection)},e=>{v({message:"删除失败",type:"error",offset:60})}).finally(()=>{p.value=!1})},o=e=>{var c;t.push({path:`/detail/${(c=e==null?void 0:e.goods)==null?void 0:c.category}/${e.jid}`})};return j(()=>{a(g.getters.collection)}),{getRowKeys:h,tableData:l,btnDelete:f,shoucangDelete:k,dialogVisible:p,goodClick:o}}},I=["onClick"],K=["src"],M={class:"operation_wrapper"},H=["onClick"],L={key:1},T=i("span",null,"是否移除此商品",-1),$={class:"dialog-footer"};function q(V,l,y,t,p,g){const a=m("el-table-column"),h=m("el-table"),f=m("el-button"),k=m("el-dialog");return _(),u(C,null,[s(h,{data:t.tableData,"row-key":t.getRowKeys},{default:n(()=>[s(a,{type:"selection","reserve-selection":!0,"row-key":"jid",width:"55"}),s(a,{label:"商品",width:"600"},{default:n(o=>[i("div",{class:"goods_wrapper",onClick:e=>t.goodClick(o.row)},[i("img",{src:o.row.goods.img,alt:""},null,8,K),i("div",null,E(o.row.goods.des),1)],8,I)]),_:1}),s(a,{prop:"price",label:"单价(元)",width:"120"}),s(a,{prop:"operation",label:"操作"},{default:n(o=>[i("div",M,[(_(!0),u(C,null,N(o.row.operation,(e,c)=>(_(),u(C,{key:c},[e=="delete"?(_(),u("div",{key:0,onClick:r=>t.btnDelete(o.row)},"删除",8,H)):e=="check"?(_(),u("div",L,"查看")):U("",!0)],64))),128))])]),_:1})]),_:1},8,["data","row-key"]),s(k,{modelValue:t.dialogVisible,"onUpdate:modelValue":l[1]||(l[1]=o=>t.dialogVisible=o),title:"确定移除",width:"30%"},{footer:n(()=>[i("span",$,[s(f,{onClick:l[0]||(l[0]=o=>t.dialogVisible=!1)},{default:n(()=>[w("取消")]),_:1}),s(f,{type:"primary",onClick:t.shoucangDelete},{default:n(()=>[w("确定")]),_:1},8,["onClick"])])]),default:n(()=>[T]),_:1},8,["modelValue"])],64)}const O=D(F,[["render",q]]);export{O as default};
