import{_ as y,a as E,g as h,i as x,r as g,o as m,c,b as n,t as w,e as d,A as p,J as C,K as P,M as b,N as B,f as V,p as I,q as N}from"./index-4b07255f.js";const S={name:"Login",setup(a){const r=E(),u=h(),e=x({user:"",pass:"",phone:""}),_=h(!1);function v(){u.value.validate(t=>{if(t){const l={user:e.user,pass:window.btoa(e.pass)};C(l).then(o=>{if(o.code==1){if(o.token)P("token",o.token);else throw"获取token失败";r.push({path:"/home"})}else b({title:"登录失败",message:o.mes,type:"warning"})},o=>{console.log(o)})}else return console.log("error submit!!"),!1})}function i(){u.value.validate(t=>{if(t){const l={user:e.user,phone:window.btoa(e.phone)};B(l).then(o=>{b({title:"重置成功",message:o.mes,type:"success"})},o=>{console.log(o)})}else return console.log("error submit!!"),!1})}return{ruleForm:e,rules:{user:[{validator:(t,l,o)=>{l===""?o(new Error("请输入用户名")):o()},trigger:"change"}],pass:[{validator:(t,l,o)=>{l===""?o(new Error("请输入密码")):e.user===""?o(new Error("请先输入用户名")):o()},trigger:"change"}],phone:[{validator:(t,l,o)=>{l===""?o(new Error("请输入手机号")):e.user===""?o(new Error("请先输入用户名")):o()},trigger:"change"}]},ruleFormRef:u,submitForm:v,forgetForm:i,register:function(){r.push({path:"/register"})},isForget:_}}},k=a=>(I("data-v-0b1f4cba"),a=a(),N(),a),L={class:"login_wrapper"},R={class:"login_form"},U={class:"login_form_header"},q=k(()=>n("div",{class:"login_form_line"},null,-1)),A=k(()=>n("div",{class:"login_form_line"},null,-1));function D(a,r,u,e,_,v){const i=g("el-input"),f=g("el-form-item"),F=g("el-form");return m(),c("div",L,[n("div",R,[n("div",U,w(e.isForget?"密码重置":"欢迎登陆"),1),q,d(F,{ref:"ruleFormRef",model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"60px",class:"demo-ruleForm"},{default:p(()=>[d(f,{label:"用户名",prop:"user"},{default:p(()=>[d(i,{modelValue:e.ruleForm.user,"onUpdate:modelValue":r[0]||(r[0]=s=>e.ruleForm.user=s),placeholder:"用户名",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e.isForget?(m(),V(f,{key:1,label:"手机号",prop:"phone"},{default:p(()=>[d(i,{modelValue:e.ruleForm.phone,"onUpdate:modelValue":r[2]||(r[2]=s=>e.ruleForm.phone=s),autocomplete:"off"},null,8,["modelValue"])]),_:1})):(m(),V(f,{key:0,label:"密码",prop:"pass"},{default:p(()=>[d(i,{modelValue:e.ruleForm.pass,"onUpdate:modelValue":r[1]||(r[1]=s=>e.ruleForm.pass=s),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}))]),_:1},8,["model","rules"]),e.isForget?(m(),c("p",{key:0,class:"login_btn",onClick:r[3]||(r[3]=(...s)=>e.forgetForm&&e.forgetForm(...s))},"重置")):(m(),c("p",{key:1,class:"login_btn",onClick:r[4]||(r[4]=(...s)=>e.submitForm&&e.submitForm(...s))},"登录")),A,n("span",{class:"forget",onClick:r[5]||(r[5]=s=>e.isForget=!e.isForget)},w(e.isForget?"立即登录":"密码重置"),1),n("span",{class:"register",onClick:r[6]||(r[6]=(...s)=>e.register&&e.register(...s))},"立即注册")])])}const M=y(S,[["render",D],["__scopeId","data-v-0b1f4cba"]]);export{M as default};
